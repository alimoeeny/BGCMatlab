function [true, cellid, clid] = isacell(DATA, row, p, clid, varargin)%[true, cellid, clid] = isacell(DATA, row, p, clid)%True = there is cell defined on this row,probelisttype = 'default';j = 1;while j <= length(varargin)    if strcmp(varargin{j},'autolist')        listtype = varargin{j};    end    j = j+1;endif strcmp(listtype,'autolist') && isfield(DATA,'autolist')    CellList = DATA.autolist.CellList;else    CellList = DATA.CellList;end        cellid = 0;        if isfield(row,'p')            cell = row;            p = cell.p;            if isfield(cell,'eid')                row = cell.eid;            else                row = DATA.currentpoint(1);            end            clid = cell.cl;        elseif nargin > 3            if clid <= size(CellList,3)                cellid = CellList(row,p,clid);            else                cellid = 0;            end            true = cellid > 0;            return;        elseif rem(p,1) > 0            clid = round(rem(p,1) .* 10);            p = floor(p);        else            clid = 0;        end        if size(CellList,1)  >= row            true = sum(CellList(row,p,:) > 0);            true = sum(true);            dup = CellList(row,p,:) < 0;        else            true = 0;        end        if true %if spefified a cl, only report cell value for this            if clid > 0                 if length(p) > 1                    if length(row) == 1                        row = ones(size(p)).*row;                    end                    if max(clid) > size(CellList,3)                        CellList(:,:,max(clid)) = 0;                    end                    id = sub2ind(size(CellList),row,p,clid);                    cellid = CellList(id);                elseif size(CellList,3) >= clid                    cellid = CellList(row,p,clid);                else                    cellid = 0;                end            else                                cellid = CellList(row,p,:);                clid = find(cellid > 0);                cellid = cellid(cellid>0);            end        end                