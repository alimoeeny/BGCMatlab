function PlotRateCheck(R)    hold off;    if strcmp(R.plottype,'image');        imagesc(R.Im,'buttondownfcn',{@PC.HitImage, 'CellRates'});    else        sym = 'osx+<v>^*ph.osx+<v>^*ph.';        colors = mycolors;        if strcmp(R.plottype,'skew');            x = R.blkff;            y = R.blkskew;        else            x = R.blkff;            y = R.blkcv;        end        hold off;    for j = 1:size(R.blkcv,1);        for k = 1:size(R.blkcv,2);            h = plot(x(j,k),y(j,k),sym(j),'color',colors{k},'buttondownfcn',{@PC.HitExptPoint,j,R.cellid(k)});            if R.warning(j,k)                set(h,'linewidth',2);            end            hold on;        end    end    xlabel('Fano Factor (blockwise)');    if strcmp(R.plottype,'skew');        set(gca,'xscale','log','yscale','lin');        ylabel('Skewness');    else        set(gca,'xscale','log','yscale','log');        ylabel('SD/mean(blockwise)');    end    end [R.sortedval, R.sid] = sort(R.blkff(:),'descend');setappdata(gcf,'RateCheckData',R);setappdata(gcf,'CurrentRatePoint',1);fgf;AddNextButton(gcf);function AddNextButton(F)o = findobj(allchild(F),'flat','tag','NextButton');if isempty(o)    o = uicontrol(F, 'style','pushbutton','String','next', 'callback', {@NextButton, 1},...        'units','normalized','position',[0.9 0.08 0.1 0.08]);endo = findobj(allchild(F),'flat','tag','PrevButton');if isempty(o)    o = uicontrol(F, 'style','pushbutton','String','Prev', 'callback', {@NextButton, -1},...        'units','normalized','position',[0.9 0.0 0.1 0.08]);endfunction NextButton(src, event, step, varargin)F = GetFigure(src);R = getappdata(F,'RateCheckData');id = getappdata(F,'CurrentRatePoint');id = id+step;[a,b] = ind2sub(size(R.blkcv),R.sid(id));while R.blkcv(a,b) == 0 && id < length(R.blkcv(:))    id = id+step;    [a,b] = ind2sub(size(R.blkcv),R.sid(id));endfprintf('Sort Val %.4f\n',R.sortedval(id));if  id > length(R.blkcv(:))    fprintf('Reached end of list.  Starting again\n');    id = 1;endsetappdata(F,'CurrentRatePoint',id);PC.HitExptPoint(F, event,a,R.cellid(b));figure(F);if isappdata(F,'PointMarker') & ishandle(getappdata(F,'PointMarker'))    delete(getappdata(F,'PointMarker'));endxy = gui.data2norm(gca, [R.blkff(a,b) R.blkcv(a,b)]);h = annotation('ellipse',[xy(1)-0.02 xy(2)-0.02 0.04 0.04]);set(h,'buttondownfcn',{@PC.HitExptPoint,a,R.cellid(b)});setappdata(F,'PointMarker',h);