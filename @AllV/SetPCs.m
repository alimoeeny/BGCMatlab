function DATA = SetPCs(DATA, replot, reapply)    AllVoltages = AllV.mygetappdata(DATA,'AllVoltages');    args = {};    if reapply && AllV.NeedEV(DATA.cluster);        if ~isfield(DATA.cluster,'Evec')            [DATA, Cd] = AllV.LoadClusterDetails(DATA, 'orauto');            if length(Cd) >= DATA.probe(1) && isfield(Cd{DATA.probe(1)},'Evec')                args = {args{:} 'Evec' Cd{DATA.probe(1)}.Evec };            end        else                args = {args{:} 'Evec' DATA.cluster.Evec };        end    end    if isfield(DATA,'nprobepc')        np = DATA.nprobepc;    else        np = -1;    end    [C, DATA.Evec, pcs, dip, chspk, errs, DATA.pcfit] = AllV.CalcPCs(DATA, AllVoltages,np, args{:});    DATA = AllV.AddErr(DATA, errs);    DATA = rmfields(DATA,'pcs'); %don't want old pcs left in here    DATA.pcs(DATA.uid,1:size(pcs,2)) = pcs; %now done in CalcPcs    DATA.dipvals = dip;    if replot        DATA = AllV.ReplotPCs(DATA,[]);    end