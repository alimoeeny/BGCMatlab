function xy = PlotOneXY(DATA,names, varargin) %AllV.PlotOneXY(DATA, names, ...); XY scatterplot of values defined by names%typically AllV.PlotOneXY(DATA, DATA.xyplot.xy); plots in current window% ..., 'default') only plot if DATA.watchplots > 0 (eg. do nothing when% noninteractive. Uses defualt window% ..., 'show') forces ploting in default windowxy = [];    if length(names) < 2 || DATA.interactive < 0        return;    end        j = 1;    while j <= length(varargin)        if strcmp(varargin{j},'default')            if DATA.watchplots                AllV.SetFigure(DATA.tag.tmplscore, DATA);            else                return;            end        elseif strcmp(varargin{j},'show')            AllV.SetFigure(DATA.tag.tmplscore, DATA);        end               j = j+1;    end        if DATA.xyplot.space(1) == 0        return;    end    dim = [DATA.xyplot.space; DATA.xyplot.id];    [x, xid] = AllV.GetValues(DATA,names{1},dim(:,1));    [y, yid] = AllV.GetValues(DATA,names{2},dim(:,2));    if DATA.xyplot.density        args = {'density'};    else        args = {};    end    if isempty(x)    elseif length(x) == length(y) && length(x) == length(DATA.clst)%        GetFigure(DATA.tag.tmplscore);        hold off;        if DATA.xyplot.density == 1            DensityPlot(x,y,'sd',[2 2],'ynormal');        else           PlotND([x y],[],'idlist',DATA.clst,'colors',DATA.colors,args{:});        end    else        cprintf('red','length mismatch %d vs %d\n',length(x),length(y));    end    if isfield(DATA.cluster,'space') && length(DATA.cluster.space) > 2        if DATA.cluster.space(2) == xid(1) && DATA.cluster.space(3) == yid(1)            DATA.cluster.color = 'r';            AllV.DrawEllipse(DATA.cluster);        end    end    for j = 1:length(DATA.cluster.next)        if isfield(DATA.cluster.next{j},'space')            C = DATA.cluster.next{j};            if length(C.space) > 2 && sum(ismember(C.space(2:3),[xid yid])) == 2                C.color = 'g';                AllV.DrawEllipse(C);            end        end    end    X.Variables = names;    X.pcplot = [xid(:)' yid(:)'];    X.ClusterSpace = [DATA.xyplot.space(1) xid(:)' yid(:)'];    set(gca,'UserData',X);    setappdata(gcf,'ClusterSpace',[DATA.xyplot.space(1) xid(:)' yid(:)']);    xlabel(names{1});    ylabel(names{2});    if length(x) == length(y)        xy = [x y];    end