function clusterplot = GetClusterPlot(DATA,E,plots, pt)%plots is sxN list of plot spaces%E is custter ddef%pt is row of plots ot uesd    clusterplot = 0;     spaces = [1 2 3 3 5 6 7 8 9 10];    if isfield(E,'pcplot') && ~isempty(E.pcplot)        pcplot = E.pcplot;    elseif isfield(E,'space')        pcplot = E.space(2:end);    else        return;    end    if isfield(E, 'auto') && ismember(E.auto, [2 3]) %Ecker auto        if DATA.plottype == 11 || E.space(1) == 1            if sum(plots(pt,:) == E.space(2:3)) == 2                clusterplot = pt;            end        end        return;    end    if ~isfield(E,'shape') || E.shape(1) == 3        return;    end    if E.shape == 2 || length(pcplot) < 2        clusterplot = 0;    elseif strcmp(DATA.plottype,'adcdvdy') && length(pcplot) == 4 && sum(DATA.vpts(pt,:) == pcplot) == 4        clusterplot = pt;    elseif DATA.plottype == 2 && length(pcplot) == 4 && sum(DATA.vpts(pt,:) == pcplot) == 4        clusterplot = pt;    elseif ismember(DATA.plottype,[1 3 4]) && sum(plots(pt,:) == pcplot(1:size(plots,2))) == 2 ...        && spaces(DATA.plottype) == E.space(1)        clusterplot = pt;    elseif ismember(DATA.plottype,[11]) && sum(plots(pt,:) == pcplot(1:size(plots,2))) == 2         clusterplot = pt;    end    if isfield(E,'space') && length(E.space) > 2 && E.space(1) == DATA.plottype        if E.space(1) == 2 && sum(DATA.vsmps(plots(pt,:)) == E.space([3 5])) == 2            if DATA.vpts(pt,3) == E.space(4) %check probe too                clusterplot= pt;            end        elseif E.space(1) ~= 2 && sum(plots(pt,:) == E.space(2:3)) == 2            clusterplot= pt;        end    end