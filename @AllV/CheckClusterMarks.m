function DATA = CheckClusterMarks(Clusters, DATA)        if isfield(DATA,'ArrayConfig')        A = DATA.ArrayConfig;    else        return;    end    if ~isfield(A,'badexpts')        return;    end    A.badexpts(end+1:floor(DATA.exptno)) = 0;    A.badprobes(end+1:DATA.allnprobes) = 0;    e = 0;    if isfield(DATA,'exptno')        e = DATA.exptno;    end    nerr = 0;    for j = 1:length(Clusters)        C = Clusters{j};        if isfield(C,'marked') && isfield(C,'exptno')            e = C.exptno;            if e > length(A.badexpts)                fprintf('E%d larger than arrayconfig.badexpts\n',e,j);                nerr = nerr+1;                            elseif C.marked == -1000 & A.badexpts(e) == 0                fprintf('E%dP%d BadExpt in Cluster, not in arrayconfig\n',e,j);                nerr = nerr+1;            end            if C.marked == 3 & A.badprobes(j) == 0                fprintf('E%dP%d BadProbe in Cluster, not in arrayconfig\n',e,j);                nerr = nerr+1;            end        end    end    if nerr && DATA.interactive >= 0        msg = sprintf('%d Bad Marks in Expt%d Clusters',nerr,e);        DATA.errpopup = msgbox(msg);        set(DATA.toplevel,'Name',msg);    end  